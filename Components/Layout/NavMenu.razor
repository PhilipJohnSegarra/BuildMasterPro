
@inject NavigationManager NavigationManager
@rendermode InteractiveServer
@using BuildMasterPro.Data
@inject BuildMasterPro.Data.ApplicationDbContext context
@using Microsoft.EntityFrameworkCore
@using Microsoft.AspNetCore.Components

<nav class="Sidebar" style="">
    <button class="MenuLink" style="border-color:transparent;margin:1rem 0 100px 0;" @onclick="@(() => collapsed = collapsed != true? true : false)">
        <div class="Navlink-Container">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="12" viewBox="0 0 18 12" fill="none">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M0 1.21875C0 0.994974 0.0888948 0.780362 0.247129 0.622129C0.405362 0.463895 0.619974 0.375 0.84375 0.375H17.1562C17.38 0.375 17.5946 0.463895 17.7529 0.622129C17.9111 0.780362 18 0.994974 18 1.21875C18 1.44253 17.9111 1.65714 17.7529 1.81537C17.5946 1.97361 17.38 2.0625 17.1562 2.0625H0.84375C0.619974 2.0625 0.405362 1.97361 0.247129 1.81537C0.0888948 1.65714 0 1.44253 0 1.21875ZM0 6C0 5.77622 0.0888948 5.56161 0.247129 5.40338C0.405362 5.24514 0.619974 5.15625 0.84375 5.15625H17.1562C17.38 5.15625 17.5946 5.24514 17.7529 5.40338C17.9111 5.56161 18 5.77622 18 6C18 6.22378 17.9111 6.43839 17.7529 6.59662C17.5946 6.75485 17.38 6.84375 17.1562 6.84375H0.84375C0.619974 6.84375 0.405362 6.75485 0.247129 6.59662C0.0888948 6.43839 0 6.22378 0 6ZM0.84375 9.9375C0.619974 9.9375 0.405362 10.0264 0.247129 10.1846C0.0888948 10.3429 0 10.5575 0 10.7812C0 11.005 0.0888948 11.2196 0.247129 11.3779C0.405362 11.5361 0.619974 11.625 0.84375 11.625H17.1562C17.38 11.625 17.5946 11.5361 17.7529 11.3779C17.9111 11.2196 18 11.005 18 10.7812C18 10.5575 17.9111 10.3429 17.7529 10.1846C17.5946 10.0264 17.38 9.9375 17.1562 9.9375H0.84375Z" fill="#121114" />
            </svg>

        </div>
    </button>
    <a class="MenuLink" href="" @onclick="@(()=>NavActive("Home"))" style="@NavLinkBorder["Home"]">
        <div class="Navlink-Container">
            <svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 18 18'>
                <path d='M3 18C1.34315 18 0 16.6569 0 15V7.60555C0 6.60249 0.501303 5.6658 1.3359 5.1094L7.3359 1.1094C8.3436 0.437602 9.6564 0.437602 10.6641 1.1094L16.6641 5.1094C17.4987 5.6658 18 6.60249 18 7.60555V15C18 16.6569 16.6569 18 15 18H14.25C12.5931 18 11.25 16.6569 11.25 15V13.25C11.25 12.0074 10.2426 11 9 11C7.75736 11 6.75 12.0074 6.75 13.25V15C6.75 16.6569 5.40685 18 3.75 18H3Z' fill='@NavLinkIcon["Home"]' />
            </svg>
            @if (!collapsed)
            {
                <p style="margin:0 0 0 1rem;@NavLinkFont["Home"]">Home</p>
            }
            
            
        </div>
    </a>
    <a class="MenuLink" href="" @onclick="@(()=>NavActive("AllMessages"))" style="@NavLinkBorder["AllMessages"]">
        <div class="Navlink-Container" style="">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="14" viewBox="0 0 20 16" style="margin:3px 0 0 0;" fill="none">
                <path d="M1.79556 15.5556C1.2837 15.5556 0.856667 15.3844 0.514445 15.0422C0.172222 14.7 0.000740741 14.2726 0 13.76V1.79556C0 1.2837 0.171482 0.856666 0.514445 0.514444C0.857408 0.172222 1.28407 0.000740741 1.79444 0H18.2056C18.7167 0 19.1433 0.171481 19.4856 0.514444C19.8278 0.857407 19.9993 1.28444 20 1.79556V13.7611C20 14.2722 19.8285 14.6993 19.4856 15.0422C19.1426 15.3852 18.7159 15.5563 18.2056 15.5556H1.79556ZM10 7.90667L18.8889 2.09444L18.5467 1.11111L10 6.66667L1.45333 1.11111L1.11111 2.09444L10 7.90667Z" fill="@NavLinkIcon["AllMessages"]" />
            </svg>
            @if (!collapsed)
            {
                <p style="margin:0 0 0 1rem;@NavLinkFont["AllMessages"]">All Messages</p>
            }
            
        </div>
    </a>
    <a class="MenuLink" href="resources" @onclick="@(()=>NavActive("AllResources"))" style="@NavLinkBorder["AllResources"]">
        <div class="Navlink-Container" style="">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" fill="none">
                <mask id="path-1-inside-1_179_263" fill="white">
                    <path d="M2.616 18C2.168 18 1.78667 17.8427 1.472 17.528C1.15733 17.2133 1 16.8323 1 16.385V5.263C0.713333 5.14433 0.475 4.952 0.285 4.686C0.0950001 4.41933 0 4.11367 0 3.769V1.615C0 1.16833 0.157333 0.787333 0.472 0.472C0.786667 0.157333 1.168 0 1.616 0H16.385C16.8317 0 17.2127 0.157333 17.528 0.472C17.8427 0.786667 18 1.168 18 1.616V3.769C18 4.11367 17.905 4.419 17.715 4.685C17.5257 4.95167 17.2873 5.14433 17 5.263V16.385C17 16.8317 16.8427 17.2127 16.528 17.528C16.2133 17.8427 15.8323 18 15.385 18H2.616ZM1.616 4.385H16.385C16.5643 4.385 16.7117 4.327 16.827 4.211C16.9423 4.09567 17 3.94867 17 3.77V1.615C17 1.43567 16.9423 1.28833 16.827 1.173C16.7117 1.05767 16.5643 1 16.385 1H1.615C1.43567 1 1.28833 1.05767 1.173 1.173C1.05767 1.28833 1 1.436 1 1.616V3.769C1 3.949 1.05767 4.09633 1.173 4.211C1.28833 4.32633 1.436 4.384 1.616 4.384M6.827 9.866H11.192C11.322 9.866 11.425 9.82433 11.501 9.741C11.5777 9.65833 11.616 9.55233 11.616 9.423C11.616 9.29367 11.5777 9.191 11.501 9.115C11.4243 9.039 11.3213 9.00067 11.192 9H6.808C6.67867 9 6.57567 9.03833 6.499 9.115C6.423 9.191 6.385 9.29367 6.385 9.423C6.385 9.55233 6.42633 9.65833 6.509 9.741C6.59167 9.82367 6.69767 9.86533 6.827 9.866Z" />
                </mask>
                <path d="M2.616 18C2.168 18 1.78667 17.8427 1.472 17.528C1.15733 17.2133 1 16.8323 1 16.385V5.263C0.713333 5.14433 0.475 4.952 0.285 4.686C0.0950001 4.41933 0 4.11367 0 3.769V1.615C0 1.16833 0.157333 0.787333 0.472 0.472C0.786667 0.157333 1.168 0 1.616 0H16.385C16.8317 0 17.2127 0.157333 17.528 0.472C17.8427 0.786667 18 1.168 18 1.616V3.769C18 4.11367 17.905 4.419 17.715 4.685C17.5257 4.95167 17.2873 5.14433 17 5.263V16.385C17 16.8317 16.8427 17.2127 16.528 17.528C16.2133 17.8427 15.8323 18 15.385 18H2.616ZM1.616 4.385H16.385C16.5643 4.385 16.7117 4.327 16.827 4.211C16.9423 4.09567 17 3.94867 17 3.77V1.615C17 1.43567 16.9423 1.28833 16.827 1.173C16.7117 1.05767 16.5643 1 16.385 1H1.615C1.43567 1 1.28833 1.05767 1.173 1.173C1.05767 1.28833 1 1.436 1 1.616V3.769C1 3.949 1.05767 4.09633 1.173 4.211C1.28833 4.32633 1.436 4.384 1.616 4.384M6.827 9.866H11.192C11.322 9.866 11.425 9.82433 11.501 9.741C11.5777 9.65833 11.616 9.55233 11.616 9.423C11.616 9.29367 11.5777 9.191 11.501 9.115C11.4243 9.039 11.3213 9.00067 11.192 9H6.808C6.67867 9 6.57567 9.03833 6.499 9.115C6.423 9.191 6.385 9.29367 6.385 9.423C6.385 9.55233 6.42633 9.65833 6.509 9.741C6.59167 9.82367 6.69767 9.86533 6.827 9.866Z" fill="@NavLinkIcon["AllResources"]" />
                <path d="M1 16.385H2H1ZM1 5.263H2V4.59466L1.38248 4.33904L1 5.263ZM0.285 4.686L-0.529421 5.26628L-0.528733 5.26724L0.285 4.686ZM0.472 0.472L-0.235107 -0.235107L-0.235855 -0.234358L0.472 0.472ZM17.528 0.472L18.2351 -0.235107L18.2344 -0.235855L17.528 0.472ZM17.715 4.685L16.9013 4.10376L16.8996 4.10608L17.715 4.685ZM17 5.263L16.6183 4.33872L16 4.59407V5.263H17ZM16.528 17.528L17.2351 18.2351L17.2359 18.2344L16.528 17.528ZM16.827 4.211L16.1199 3.50389L16.1179 3.50593L16.827 4.211ZM1.173 4.211L1.88011 3.50389L1.87805 3.50185L1.173 4.211ZM6.827 9.866L6.82185 10.866H6.827V9.866ZM11.501 9.741L10.7678 9.06098L10.7621 9.06715L11.501 9.741ZM11.192 9L11.1972 8H11.192V9ZM2.616 17C2.43121 17 2.30482 16.9466 2.17911 16.8209L0.764893 18.2351C1.26851 18.7387 1.90479 19 2.616 19V17ZM2.17911 16.8209C2.05308 16.6949 2 16.5687 2 16.385H0C0 17.096 0.26159 17.7318 0.764893 18.2351L2.17911 16.8209ZM2 16.385V5.263H0V16.385H2ZM1.38248 4.33904C1.27827 4.2959 1.18601 4.22695 1.09873 4.10476L-0.528733 5.26724C-0.236009 5.67705 0.148395 5.99277 0.617522 6.18696L1.38248 4.33904ZM1.09942 4.10573C1.03671 4.0177 1 3.91728 1 3.769H-1C-1 4.31006 -0.846705 4.82096 -0.529421 5.26627L1.09942 4.10573ZM1 3.769V1.615H-1V3.769H1ZM1 1.615C1 1.43239 1.05283 1.30565 1.17985 1.17836L-0.235855 -0.234358C-0.738162 0.269013 -1 0.90428 -1 1.615H1ZM1.17911 1.17911C1.30482 1.05339 1.43121 1 1.616 1V-1C0.904792 -1 0.268511 -0.738725 -0.235107 -0.235107L1.17911 1.17911ZM1.616 1H16.385V-1H1.616V1ZM16.385 1C16.5676 1 16.6943 1.05283 16.8216 1.17985L18.2344 -0.235855C17.731 -0.738162 17.0957 -1 16.385 -1V1ZM16.8209 1.17911C16.9466 1.30482 17 1.43121 17 1.616H19C19 0.904791 18.7387 0.268511 18.2351 -0.235107L16.8209 1.17911ZM17 1.616V3.769H19V1.616H17ZM17 3.769C17 3.91728 16.9633 4.0169 16.9013 4.10376L18.5287 5.26624C18.8467 4.8211 19 4.31005 19 3.769H17ZM16.8996 4.10608C16.8135 4.22744 16.7221 4.29583 16.6183 4.33872L17.3817 6.18728C17.8525 5.99284 18.2379 5.6759 18.5304 5.26392L16.8996 4.10608ZM16 5.263V16.385H18V5.263H16ZM16 16.385C16 16.5676 15.9472 16.6943 15.8201 16.8216L17.2359 18.2344C17.7382 17.731 18 17.0957 18 16.385H16ZM15.8209 16.8209C15.6949 16.9469 15.5687 17 15.385 17V19C16.096 19 16.7318 18.7384 17.2351 18.2351L15.8209 16.8209ZM15.385 17H2.616V19H15.385V17ZM1.616 5.385H16.385V3.385H1.616V5.385ZM16.385 5.385C16.8023 5.385 17.2141 5.23996 17.5361 4.91607L16.1179 3.50593C16.1544 3.46923 16.2044 3.43433 16.2637 3.41101C16.3211 3.3884 16.3658 3.385 16.385 3.385V5.385ZM17.5341 4.91811C17.8558 4.59643 18 4.18605 18 3.77H16C16 3.75067 16.0034 3.70618 16.0258 3.64905C16.0489 3.59014 16.0835 3.54029 16.1199 3.50389L17.5341 4.91811ZM18 3.77V1.615H16V3.77H18ZM18 1.615C18 1.19944 17.8565 0.788314 17.5341 0.465893L16.1199 1.88011C16.0831 1.84333 16.0485 1.79326 16.0255 1.73448C16.0033 1.67756 16 1.63353 16 1.615H18ZM17.5341 0.465893C17.2117 0.143472 16.8006 0 16.385 0V2C16.3665 2 16.3224 1.99674 16.2655 1.97446C16.2067 1.95145 16.1567 1.91688 16.1199 1.88011L17.5341 0.465893ZM16.385 0H1.615V2H16.385V0ZM1.615 0C1.19944 0 0.788315 0.143471 0.465893 0.465893L1.88011 1.88011C1.84333 1.91688 1.79326 1.95145 1.73448 1.97446C1.67755 1.99674 1.63353 2 1.615 2V0ZM0.465893 0.465893C0.142727 0.78906 0 1.20094 0 1.616H2C2 1.63374 1.99689 1.6773 1.97474 1.73401C1.95184 1.79266 1.91726 1.84295 1.88011 1.88011L0.465893 0.465893ZM0 1.616V3.769H2V1.616H0ZM0 3.769C0 4.18402 0.142786 4.59687 0.467946 4.92015L1.87805 3.50185C1.91607 3.53965 1.95124 3.59068 1.97446 3.65002C1.9969 3.70736 2 3.7513 2 3.769H0ZM0.465893 4.91811C0.789061 5.24128 1.20094 5.384 1.616 5.384V3.384C1.63374 3.384 1.67729 3.38711 1.73401 3.40926C1.79266 3.43216 1.84295 3.46674 1.88011 3.50389L0.465893 4.91811ZM6.827 10.866H11.192V8.866H6.827V10.866ZM11.192 10.866C11.556 10.866 11.9448 10.7384 12.2399 10.4148L10.7621 9.06715C10.8234 9 10.9024 8.94387 10.9917 8.90773C11.0778 8.8729 11.15 8.866 11.192 8.866V10.866ZM12.2342 10.421C12.5077 10.1262 12.616 9.76472 12.616 9.423H10.616C10.616 9.38855 10.6212 9.33026 10.6469 9.25942C10.6733 9.18634 10.715 9.11792 10.7678 9.061L12.2342 10.421ZM12.616 9.423C12.616 9.08359 12.5079 8.70504 12.205 8.40481L10.797 9.82519C10.731 9.75973 10.6811 9.68089 10.6504 9.59879C10.621 9.52007 10.616 9.45671 10.616 9.423H12.616ZM12.205 8.40481C11.9064 8.10878 11.533 8.00174 11.1972 8.00001L11.1868 9.99999C11.1545 9.99982 11.0935 9.99474 11.0175 9.96645C10.9382 9.93697 10.8614 9.88908 10.797 9.82519L12.205 8.40481ZM11.192 8H6.808V10H11.192V8ZM6.808 8C6.4683 8 6.09162 8.10817 5.79189 8.40789L7.20611 9.82211C7.14149 9.88673 7.06372 9.93574 6.98254 9.96595C6.90463 9.99494 6.84179 10 6.808 10V8ZM5.79189 8.40789C5.49117 8.70862 5.385 9.08613 5.385 9.423H7.385C7.385 9.45579 7.38016 9.5182 7.35133 9.59611C7.32123 9.67742 7.272 9.75621 7.20611 9.82211L5.79189 8.40789ZM5.385 9.423C5.385 9.78663 5.5109 10.1571 5.80189 10.4481L7.21611 9.03389C7.26984 9.08763 7.31667 9.15671 7.34767 9.23621C7.37791 9.31373 7.385 9.38023 7.385 9.423H5.385ZM5.80189 10.4481C6.09145 10.7377 6.45975 10.8641 6.82185 10.866L6.83215 8.86601C6.87437 8.86623 6.93992 8.87353 7.01633 8.90357C7.09467 8.93436 7.16289 8.98068 7.21611 9.03389L5.80189 10.4481Z" fill="black" mask="url(#path-1-inside-1_179_263)" />
            </svg>
            @if (!collapsed)
            {
                <p style="margin:0 0 0 1rem;@NavLinkFont["AllResources"]">All Resources</p>
            }
            
        </div>
    </a>
    <a class="MenuLink" href="projects/create" @onclick="@(()=>NavActive("newProject"))" style="@NavLinkBorder["newProject"]">
        <div class="Navlink-Container" style="">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M10 0C7.35779 0.0320595 4.83284 1.09592 2.96438 2.96438C1.09592 4.83284 0.0320595 7.35779 0 10C0.0320595 12.6422 1.09592 15.1672 2.96438 17.0356C4.83284 18.9041 7.35779 19.9679 10 20C12.6422 19.9679 15.1672 18.9041 17.0356 17.0356C18.9041 15.1672 19.9679 12.6422 20 10C19.9679 7.35779 18.9041 4.83284 17.0356 2.96438C15.1672 1.09592 12.6422 0.0320595 10 0ZM15.7143 10.7143H10.7143V15.7143H9.28571V10.7143H4.28571V9.28571H9.28571V4.28571H10.7143V9.28571H15.7143V10.7143Z" fill="url(#paint0_linear_182_356)" />
                <defs>
                    <linearGradient id="paint0_linear_182_356" x1="4.5" y1="2" x2="15" y2="18.5" gradientUnits="userSpaceOnUse">
                        <stop stop-color="#5A3E9F" />
                        <stop offset="1" stop-color="#9747FF" />
                    </linearGradient>
                </defs>
            </svg>
            @if (!collapsed)
            {
                <p style="margin:0 0 0 1rem;@NavLinkFont["newProject"]">New Project</p>
            }
            
        </div>
    </a>
    
</nav>



@code {
    private string? currentUrl;

    public bool collapsed = false;

    [Parameter]
    public bool _open { get; set; }

    public Dictionary<string, string> NavLinkFont { get; set; } = new()
    {
        {"Home", "color:#5A3E9F" },
        {"AllMessages", "color:#121114;"},
        {"AllResources", "color:#121114;"},
        {"newProject", "color:#121114;"}
    };
    public Dictionary<string, string> NavLinkIcon { get; set; } = new()
    {
        {"Home", "#5A3E9F" },
        {"AllMessages", "#121114"},
        {"AllResources", "#121114"},
        {"newProject", "#121114"}
    };

    public Dictionary<string, string> NavLinkBorder { get; set; } = new()
    {
        {"Home", "border-color:#5A3E9F;" },
        {"AllMessages", "border-color:transparent;"},
        {"AllResources", "border-color:transparent;"},
        {"newProject", "border-color:transparent;"}
    };


    protected async override Task OnInitializedAsync()
    {
        currentUrl = NavigationManager.ToBaseRelativePath(NavigationManager.Uri);
        NavigationManager.LocationChanged += OnLocationChanged;
        Projects = await context.Project.ToListAsync();
    }

    private void OnLocationChanged(object? sender, LocationChangedEventArgs e)
    {
        currentUrl = NavigationManager.ToBaseRelativePath(e.Location);
        StateHasChanged();
    }

    public void Dispose()
    {
        NavigationManager.LocationChanged -= OnLocationChanged;
    }

    private List<Project> Projects { get; set; } = new();
    private Project? Project { get; set; } = new();

    protected override void OnAfterRender(bool firstRender)
    {

    }

    public void NavActive(string link)
    {
        foreach(var key in NavLinkFont)
        {
            if(key.Key == link)
            {
                NavLinkFont[link] = "color:#5A3E9F";
                NavLinkIcon[link] = "#5A3E9F";
                NavLinkBorder[link] = "border-color:#5A3E9F;";
                StateHasChanged();

                Console.WriteLine(link);
            }
            else
            {
                NavLinkFont[key.Key] = "color:#121114;";
                NavLinkIcon[key.Key] = "#121114";
                NavLinkBorder[key.Key] = "border-color:transparent;";
                StateHasChanged();
            }
        }


    }

    private void Collapse()
    {
        
    }

    private void HoveredState()
    {

    }

    private void ToggleDrawer()
    {
        StateHasChanged();
    }

    const string HomeIcon = @"
            <svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 18 18'>
                <path d='M3 18C1.34315 18 0 16.6569 0 15V7.60555C0 6.60249 0.501303 5.6658 1.3359 5.1094L7.3359 1.1094C8.3436 0.437602 9.6564 0.437602 10.6641 1.1094L16.6641 5.1094C17.4987 5.6658 18 6.60249 18 7.60555V15C18 16.6569 16.6569 18 15 18H14.25C12.5931 18 11.25 16.6569 11.25 15V13.25C11.25 12.0074 10.2426 11 9 11C7.75736 11 6.75 12.0074 6.75 13.25V15C6.75 16.6569 5.40685 18 3.75 18H3Z' fill='#5A3E9F' />
            </svg>";
}

